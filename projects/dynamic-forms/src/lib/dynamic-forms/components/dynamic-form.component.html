<form (ngSubmit)="onSubmit()" [formGroup]="form">

  <ng-container *ngFor="let control of controls" [ngSwitch]="control.controlType">
    <ng-container *ngIf="form.get(control.name) as controlRef">

      <div class="form-group">
        <div class="input-group mb-2">

          <ng-container *ngSwitchCase="'textbox'">
            <div class="input-group-prepend">
              <div class="input-group-text">
                <ion-icon [src]="svgIconBasePath + control.icon + '.svg'">></ion-icon>
              </div>
            </div>
            <input [type]="control.type" class="form-control"
              [ngClass]="{'is-invalid' : controlRef.invalid && (controlRef.dirty || controlRef.touched), 'is-valid' : controlRef.valid}"
              [formControlName]="control.name" [id]="control.name" [placeholder]="control.label" ngDefaultControl>
          </ng-container>

          <ng-container *ngSwitchCase="'email'">
            <div class="input-group-prepend">
              <div class="input-group-text">
                <ion-icon [src]="svgIconBasePath + control.icon + '.svg'">></ion-icon>
              </div>
            </div>
            <input [type]="control.type" class="form-control" [formControlName]="control.name" [id]="control.name"
              [ngClass]="{'is-invalid' : controlRef.invalid && (controlRef.dirty || controlRef.touched), 'is-valid' : controlRef.valid}"
              [placeholder]="control.label" ngDefaultControl>
          </ng-container>

          <ng-container *ngSwitchCase="'currency'">
            <div class="input-group-prepend">
              <div class="input-group-text">
                <ion-icon [src]="svgIconBasePath + control.icon + '.svg'">></ion-icon>
              </div>
            </div>
            <input [type]="'number'" class="form-control" [formControlName]="control.name" [id]="control.name"
              [ngClass]="{'is-invalid' : controlRef.invalid && (controlRef.dirty || controlRef.touched), 'is-valid' : controlRef.valid}"
              [placeholder]="control.label" ngDefaultControl>
          </ng-container>

          <ng-container *ngSwitchCase="'date'">
            <div class="input-group-prepend">
              <div class="input-group-text">
                <ion-icon [src]="svgIconBasePath + control.icon + '.svg'">></ion-icon>
              </div>
            </div>
            <input [type]="'date'" class="form-control" [formControlName]="control.name" [id]="control.name"
              [ngClass]="{'is-invalid' : controlRef.invalid && (controlRef.dirty || controlRef.touched), 'is-valid' : controlRef.valid}"
              [placeholder]="control.label" min="2018-01-01" max="2018-12-31" ngDefaultControl>
          </ng-container>

          <ng-container *ngSwitchCase="'time'">
            <div class="input-group-prepend">
              <div class="input-group-text">
                <ion-icon [src]="svgIconBasePath + control.icon + '.svg'">></ion-icon>
              </div>
            </div>
            <input [type]="'time'" class="form-control" [formControlName]="control.name" [id]="control.name"
              [ngClass]="{'is-invalid' : controlRef.invalid && (controlRef.dirty || controlRef.touched), 'is-valid' : controlRef.valid}"
              [placeholder]="control.label" min="09:00" max="18:00" ngDefaultControl>
          </ng-container>

          <ng-container *ngSwitchCase="'datetime'">
            <div class="input-group-prepend">
              <div class="input-group-text">
                <ion-icon [src]="svgIconBasePath + control.icon + '.svg'">></ion-icon>
              </div>
            </div>
            <input [type]="'datetime-local'" class="form-control" [formControlName]="control.name" [id]="control.name"
              [ngClass]="{'is-invalid' : controlRef.invalid && (controlRef.dirty || controlRef.touched), 'is-valid' : controlRef.valid}"
              [placeholder]="control.label" min="2018-06-07T09:00" max="2018-06-14T18:00" ngDefaultControl>
          </ng-container>

          <ng-container *ngSwitchCase="'textarea'">
            <div class="input-group-prepend">
              <div class="input-group-text">
                <ion-icon [src]="svgIconBasePath + control.icon + '.svg'">></ion-icon>
              </div>
            </div>
            <textarea class="form-control" [formControlName]="control.name" [id]="control.name"
              [ngClass]="{'is-invalid' : controlRef.invalid && (controlRef.dirty || controlRef.touched), 'is-valid' : controlRef.valid}"
              [placeholder]="control.label" ngDefaultControl></textarea>
          </ng-container>


          <ng-container *ngSwitchCase="'select'">
            <div class="input-group-prepend">
              <div class="input-group-text">
                <ion-icon [src]="svgIconBasePath + control.icon + '.svg'">></ion-icon>
              </div>
            </div>
            <select class="selectpicker custom-select form-control" [multiple]="control.multiple"
              data-actions-box="true" data-size="4" [formControlName]="control.name" [id]="control.name"
              [ngClass]="{'is-invalid' : controlRef.invalid && (controlRef.dirty || controlRef.touched), 'is-valid' : controlRef.valid}"
              [title]="control.label" ngDefaultControl>
              <option *ngFor="let option of control.options" [value]="option">{{option}}</option>
            </select>
          </ng-container>

          <!-- <ng-container *ngSwitchCase="'files'">
            <div class="input-group-prepend">
              <div class="input-group-text">
                <ion-icon [src]="">></ion-icon>
              </div>
            </div>
            <div class="custom-file">
              <input type="file" class="custom-file-input form-control" [multiple]="control.multiple"
                [accept]="control.accept" [formControlName]="control.name" [id]="control.name"
                [ngClass]="{'is-invalid' : controlRef.invalid && (controlRef.dirty || controlRef.touched), 'is-valid' : controlRef.valid}"
                ngDefaultControl>
              <label class="custom-file-label">{{ control.label }}</label>
            </div>
          </ng-container> -->

          <ng-container *ngSwitchCase="'address'">
            <address-form-control [formControlName]="control.name" [id]="control.name" style="width: 100%;"
              [iconSource]="'' + svgIconBasePath + control.icon + '.svg'"
              [ngClass]="{'is-invalid' : controlRef.invalid && (controlRef.dirty || controlRef.touched), 'is-valid' : controlRef.valid}"
              ngDefaultControl></address-form-control>
          </ng-container>

          <ng-container *ngSwitchCase="'photos'">
            <photos-form-control [formControlName]="control.name" [id]="control.name" style="width: 100%;"
              [control]="control" [iconSource]="'' + svgIconBasePath + control.icon + '.svg'"
              [ngClass]="{'is-invalid' : controlRef.invalid && (controlRef.dirty || controlRef.touched), 'is-valid' : controlRef.valid}"
              ngDefaultControl></photos-form-control>
          </ng-container>

          <div class="invalid-feedback">
            <ng-container *ngFor="let validation of control.validations">
              <div class="error-message" *ngIf="controlRef.hasError(validation?.type) && displayErrors">
                {{ validation?.message }}
              </div>
            </ng-container>
          </div>

        </div>
      </div>

    </ng-container>
  </ng-container>

</form>

<!-- <ion-select multiple [interfaceOptions]="{ subHeader: placeholder }" [(ngModel)]="value"
  (ionChange)="onSelection($event)" [placeholder]="placeholder" style="max-width: 90%;" ngDefaultControl>
  <ion-select-option *ngFor="let option of options" [value]="option">{{option}}</ion-select-option>
</ion-select> -->